<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="~{fragments/header :: head}"></th:block>
    <title th:text="${profile.name} + ' - Profile Details'">Profile Details - Matrimony</title>
</head>
<body th:attr="data-logged-in=${session.user != null}">
<!-- Header -->
<th:block th:replace="~{fragments/header :: navbar}"></th:block>

<div class="container">
    <div class="profile-details-container">
        <!-- Profile Details Card -->
        <div class="profile-details-card">
            <!-- Profile Header -->
            <div class="profile-details-header">
                <div class="profile-details-image">
                    <img th:src="${profile.imageUrl} ?: '/images/default-avatar.jpg'"
                         th:alt="${profile.name}">
                </div>

                <div class="profile-details-summary">
                    <h1 th:text="${profile.name}">John Doe</h1>
                    <p class="profile-id">
                        Profile ID: <strong th:text="${profile.id}">MAT12345</strong>
                        <span class="verified-badge" th:if="${profile.verified}">Verified</span>
                    </p>

                    <div class="profile-quick-info">
                        <div class="quick-info-item">
                            <span class="quick-info-label">Age</span>
                            <span class="quick-info-value" th:text="${profile.age} + ' years'">28 years</span>
                        </div>
                        <div class="quick-info-item">
                            <span class="quick-info-label">Height</span>
                            <span class="quick-info-value" th:text="${profile.height} + ' cm'">170 cm</span>
                        </div>
                        <div class="quick-info-item">
                            <span class="quick-info-label">Religion</span>
                            <span class="quick-info-value" th:text="${profile.religion}">Hindu</span>
                        </div>
                        <div class="quick-info-item">
                            <span class="quick-info-label">Location</span>
                            <span class="quick-info-value" th:text="${profile.city}">Mumbai</span>
                        </div>
                        <div class="quick-info-item">
                            <span class="quick-info-label">Marital Status</span>
                            <span class="quick-info-value" th:text="${profile.maritalStatus}">Never Married</span>
                        </div>
                        <div class="quick-info-item">
                            <span class="quick-info-label">Education</span>
                            <span class="quick-info-value" th:text="${profile.education}">Bachelor's</span>
                        </div>
                    </div>

                    <div class="profile-details-actions">
                        <button class="btn btn-primary btn-contact"
                                th:attr="data-profile-id=${profile.id}">
                            <i class="fas fa-phone"></i> Contact Now
                        </button>
                        <button class="btn btn-secondary btn-shortlist"
                                th:attr="data-profile-id=${profile.id}"
                                th:classappend="${profile.shortlisted} ? 'shortlisted' : ''">
                            <i class="fas fa-heart"></i>
                            <span th:text="${profile.shortlisted} ? 'Shortlisted' : 'Shortlist'">Shortlist</span>
                        </button>
                        <button class="btn btn-outline">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                    </div>
                </div>
            </div>

            <!-- Profile Body -->
            <div class="profile-details-body">
                <!-- About Section -->
                <div class="details-section" th:if="${profile.aboutMe}">
                    <h2 class="details-section-title">About Me</h2>
                    <p th:text="${profile.aboutMe}">
                        I am a simple, down-to-earth person who values family and relationships...
                    </p>
                </div>

                <!-- Basic Details -->
                <div class="details-section">
                    <h2 class="details-section-title">Basic Details</h2>
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">Name</span>
                            <span class="detail-value" th:text="${profile.name}">John Doe</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Age</span>
                            <span class="detail-value" th:text="${profile.age} + ' years'">28 years</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Date of Birth</span>
                            <span class="detail-value" th:text="${profile.dateOfBirth ?: 'N/A'}">15 Jan 1995</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Gender</span>
                            <span class="detail-value" th:text="${profile.gender}">Male</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Height</span>
                            <span class="detail-value" th:text="${profile.height} + ' cm'">170 cm</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Marital Status</span>
                            <span class="detail-value" th:text="${profile.maritalStatus}">Never Married</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Mother Tongue</span>
                            <span class="detail-value" th:text="${profile.motherTongue}">Hindi</span>
                        </div>
                    </div>
                </div>

                <!-- Religious Information -->
                <div class="details-section">
                    <h2 class="details-section-title">Religious Information</h2>
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">Religion</span>
                            <span class="detail-value" th:text="${profile.religion}">Hindu</span>
                        </div>
                        <div class="detail-item" th:if="${profile.caste}">
                            <span class="detail-label">Caste</span>
                            <span class="detail-value" th:text="${profile.caste}">Brahmin</span>
                        </div>
                    </div>
                </div>

                <!-- Location Details -->
                <div class="details-section">
                    <h2 class="details-section-title">Location Details</h2>
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">Country</span>
                            <span class="detail-value" th:text="${profile.country}">India</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">State</span>
                            <span class="detail-value" th:text="${profile.state}">Maharashtra</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">City</span>
                            <span class="detail-value" th:text="${profile.city}">Mumbai</span>
                        </div>
                        <div class="detail-item" th:if="${profile.pincode}">
                            <span class="detail-label">Pincode</span>
                            <span class="detail-value" th:text="${profile.pincode}">400001</span>
                        </div>
                    </div>
                </div>

                <!-- Professional Information -->
                <div class="details-section">
                    <h2 class="details-section-title">Professional Information</h2>
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">Education</span>
                            <span class="detail-value" th:text="${profile.education}">Bachelor's Degree</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Profession</span>
                            <span class="detail-value" th:text="${profile.profession}">Software Engineer</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Annual Income</span>
                            <span class="detail-value" th:text="${profile.annualIncome}">â‚¹10-15 Lakhs</span>
                        </div>
                        <div class="detail-item" th:if="${profile.employedIn}">
                            <span class="detail-label">Employed In</span>
                            <span class="detail-value" th:text="${profile.employedIn}">Private Sector</span>
                        </div>
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="details-section" th:if="${canViewContact}">
                    <h2 class="details-section-title">
                        <i class="fas fa-lock-open"></i> Contact Information
                    </h2>
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">Email</span>
                            <span class="detail-value">
                                <a th:href="'mailto:' + ${profile.email}" th:text="${profile.email}">email@example.com</a>
                            </span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Phone</span>
                            <span class="detail-value">
                                <a th:href="'tel:' + ${profile.phone}" th:text="${profile.phone}">+91 9876543210</a>
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Locked Contact (if not accessible) -->
                <div class="details-section" th:unless="${canViewContact}">
                    <h2 class="details-section-title">
                        <i class="fas fa-lock"></i> Contact Information
                    </h2>
                    <p style="color: #666; text-align: center; padding: 30px;">
                        <i class="fas fa-lock" style="font-size: 48px; margin-bottom: 15px; display: block;"></i>
                        Contact information is locked. Please login or upgrade your membership to view contact details.
                    </p>
                    <div style="text-align: center;">
                        <a th:href="@{/login}" class="btn btn-primary" th:if="${session.user == null}">
                            Login to View Contact
                        </a>
                        <button class="btn btn-primary btn-contact"
                                th:attr="data-profile-id=${profile.id}"
                                th:if="${session.user != null}">
                            Request Contact Details
                        </button>
                    </div>
                </div>

                <!-- Profile Stats -->
                <div class="details-section">
                    <h2 class="details-section-title">Profile Information</h2>
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">Profile Created</span>
                            <span class="detail-value" th:text="${profile.createdAt != null ? #temporals.format(profile.createdAt, 'dd MMM yyyy') : 'N/A'}">01 Jan 2024</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Last Active</span>
                            <span class="detail-value" th:text="${profile.lastActive}">Today</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Profile Views</span>
                            <span class="detail-value" th:text="${profile.viewCount} + ' views'">150 views</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Verification Status</span>
                            <span class="detail-value">
                                <span th:if="${profile.verified}" style="color: var(--verified-badge);">
                                    <i class="fas fa-check-circle"></i> Verified
                                </span>
                                <span th:unless="${profile.verified}" style="color: #999;">
                                    <i class="fas fa-times-circle"></i> Not Verified
                                </span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Similar Profiles Section -->
        <div class="profile-grid-section" style="margin-top: 50px;" th:if="${similarProfiles != null && !similarProfiles.isEmpty()}">
            <div class="section-header">
                <h2>Similar Profiles</h2>
                <a th:href="@{/profiles}" class="view-all-link">
                    View All <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <div class="profile-grid">
                <!-- Similar Profile Card -->
                <div class="card profile-card" th:each="similar : ${similarProfiles}">
                    <div class="profile-card-image">
                        <img th:src="${similar.imageUrl} ?: '/images/default-avatar.jpg'"
                             th:alt="${similar.name}">
                        <div class="profile-verified" th:if="${similar.verified}">
                            <span class="verified-badge">Verified</span>
                        </div>
                    </div>
                    <div class="profile-card-content">
                        <h3 th:text="${similar.name} + ', ' + ${similar.age}">Name, 28</h3>
                        <div class="profile-info">
                            <div class="profile-info-item" th:text="${similar.religion}">Hindu</div>
                            <div class="profile-info-item" th:text="${similar.city + ', ' + similar.state}">Mumbai</div>
                            <div class="profile-info-item" th:text="${similar.education}">Bachelor's</div>
                            <div class="profile-info-item" th:text="${similar.profession}">Engineer</div>
                        </div>
                        <div class="profile-card-actions">
                            <a th:href="@{/profile/{id}(id=${similar.id})}"
                               class="btn btn-primary btn-view-profile">
                                View Profile
                            </a>
                            <button class="btn btn-outline btn-shortlist"
                                    th:attr="data-profile-id=${similar.id}">
                                Shortlist
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<th:block th:replace="~{fragments/footer :: footer}"></th:block>

<!-- Contact Modal CSS -->
<style>
    .modal {
        display: flex;
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        align-items: center;
        justify-content: center;
    }

    .modal-content {
        background-color: white;
        padding: 30px;
        border-radius: 12px;
        max-width: 500px;
        width: 90%;
        position: relative;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }

    .modal-close {
        position: absolute;
        right: 15px;
        top: 15px;
        font-size: 28px;
        font-weight: bold;
        color: #999;
        cursor: pointer;
    }

    .modal-close:hover {
        color: #333;
    }

    .contact-details {
        margin-top: 20px;
    }

    .contact-details p {
        margin: 15px 0;
        font-size: 16px;
    }
</style>
</body>
</html>